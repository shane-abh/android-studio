<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Expense Calculator Main Page</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body>

<div id="chartContainer" style="height: 350px; width: 100%;"></div>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.8/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.8/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyDFzT0aZQaj0qBCjBQK6FXijL-ypyPQ-vU",
    authDomain: "expensecal-cbc8e.firebaseapp.com",
    databaseURL: "https://expensecal-cbc8e-default-rtdb.firebaseio.com",
    projectId: "expensecal-cbc8e",
    storageBucket: "expensecal-cbc8e.appspot.com",
    messagingSenderId: "907997699332",
    appId: "1:907997699332:web:e6de1f278c472b2605c451",
    measurementId: "G-1CT4L0JM1T"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

  import {getDatabase, ref, set,get, child, update, remove} from "https://www.gstatic.com/firebasejs/9.6.8/firebase-database.js"

const db = getDatabase();

  function Data(){
    const dbref = ref(db);
    var date = [];
    var bal = []

    get(child(dbref,"Expense Management2")).then((snapshot)=>{
          if (snapshot.exists()){

            snapshot.forEach((childSnapshot) => {
                var childKey = childSnapshot.key;
                var childData = childSnapshot.val();

                // console.log(childSnapshot.val().balance);
                date.push(childSnapshot.val().date);
                bal.push(childSnapshot.val().balance);


              });

            var dps =[];
            var chart = new CanvasJS.Chart("chartContainer", {
          	animationEnabled: true,
            zoomEnabled: true,
          	theme: "light2",
              exportEnabled: true,
          	title:{
          		text: "Balance Chart"
          	},

          	data: [{
          		type: "line",

              dataPoints: dps
          	}],
              slider: {

      }
          });
          var arr=[];
            for(let i=0;i<date.length;i++){
              console.log((date[i]));
              console.log(new Date(date[i]));
              // console.log(bal[i]);
              arr.push({x:new Date(date[i]),y:parseFloat(bal[i])});

            }
            // console.log(arr);
            arr.sort(function(a,b) {
                // console.log(a.x);
                return ((new Date(a.x)) - (new Date(b.x)))
            });
             for(let i=0;i<date.length;i++){
              dps.push(arr[i]);
             }

          chart.render();




          }

      })
          .catch((error)=>{
              console.log("Error");

        });
  }

      Data();




</script>



</body>
</html>